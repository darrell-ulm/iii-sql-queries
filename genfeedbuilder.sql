-- not quite matching up.
SELECT bib_view.record_num FROM  ( ( ( SELECT  DISTINCT(iiirecord.bib_record_order_record_link.bib_record_id) as recid , 121  FROM iiirecord.bib_record_order_record_link  JOIN iiirecord.order_record ON iiirecord.bib_record_order_record_link.order_record_id = iiirecord.order_record.id JOIN iiirecord.order_record_cmf ocmf ON iiirecord.order_record.id = ocmf.order_record_id LEFT JOIN public.fund_master fm ON fm.code_num = (CASE WHEN ocmf.fund_code ~ E'^\\d+$' THEN CAST(ocmf.fund_code AS INTEGER) ELSE null END) LEFT JOIN public.accounting_unit au ON au.id = fm.accounting_unit_id WHERE (order_record.accounting_unit_code_num = au.code_num OR au.code_num is null) AND fm.code  = E'engr1'  AND  (iiirecord.bib_record_order_record_link.bib_record_id) BETWEEN 420907795008 AND 420916795007 UNION SELECT  DISTINCT(iiirecord.bib_record_order_record_link.bib_record_id) as recid , 121  FROM iiirecord.bib_record_order_record_link  JOIN iiirecord.order_record ON iiirecord.bib_record_order_record_link.order_record_id = iiirecord.order_record.id JOIN iiirecord.order_record_cmf ocmf ON iiirecord.order_record.id = ocmf.order_record_id LEFT JOIN public.fund_master fm ON fm.code_num = (CASE WHEN ocmf.fund_code ~ E'^\\d+$' THEN CAST(ocmf.fund_code AS INTEGER) ELSE null END) LEFT JOIN public.accounting_unit au ON au.id = fm.accounting_unit_id WHERE (order_record.accounting_unit_code_num = au.code_num OR au.code_num is null) AND fm.code  = E'sthay'  AND  (iiirecord.bib_record_order_record_link.bib_record_id) BETWEEN 420907795008 AND 420916795007 )  INTERSECT (SELECT DISTINCT(iiirecord.bib_record.id) AS recid , 121 FROM iiirecord.bib_record WHERE (iiirecord.bib_record.id BETWEEN 420906795008 AND 423054278655 AND date_trunc('day',iiirecord.bib_record.cataloging_date) IS NOT NULL  AND (iiirecord.bib_record.id) BETWEEN 420907795008 AND 420916795007) ))  ORDER BY recid DESC LIMIT 200 )
AS bibrecid, sierra_view.bib_view
 WHERE bib_view.id = bibrecid.recid
